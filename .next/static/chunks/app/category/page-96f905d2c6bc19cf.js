(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{7859:function(e,t,r){Promise.resolve().then(r.bind(r,2910))},2910:function(e,t,r){"use strict";r.r(t);var a=r(3955),o=r(2310),s=r(8515),l=r(6008);t.default=()=>{let[e,t]=(0,o.useState)({name:"",type:"products",img:[]}),[r,n]=(0,o.useState)({id:"",name:"",type:"",img:[]}),[c,d]=(0,o.useState)(""),[i,u]=(0,o.useState)([]),[p,m]=(0,o.useState)([]),[h,y]=(0,o.useState)(!1);(0,l.useRouter)();let g=async()=>{try{let e=await fetch("/api/category",{method:"GET"});if(e.ok){let t=await e.json();u(t)}else console.error("Failed to fetch categories")}catch(e){console.error("Error:",e)}};(0,o.useEffect)(()=>{g()},[]);let b=async r=>{r.preventDefault();let a=await fetch("/api/category",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)d("Category added successfully!"),t({name:"",type:"products",img:[]}),g(),(0,l.redirect)("/category");else{let e=await a.json();d("Error: ".concat(e.error))}},x=e=>{y(!0),n({id:e.id,name:e.name,type:e.type,img:e.img}),m(e.img)},f=async e=>{e.preventDefault();try{let e=await fetch("/api/category?id=".concat(encodeURIComponent(r.id)),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name,type:r.type,img:p})});if(e.ok)window.location.reload(),n({id:"",name:"",type:"",img:[]}),y(!1),g();else{window.location.reload();let t=await e.json();d("Error: ".concat(t.error))}}catch(e){window.location.reload(),console.error("Error:",e),d("An error occurred while updating the category.")}},j=async e=>{if(confirm("Are you sure you want to delete this category?"))try{let t=await fetch("/api/category?id=".concat(encodeURIComponent(e)),{method:"DELETE"});if(t.ok)d("Category deleted successfully!"),g(),(0,l.redirect)("/category");else{let e=await t.json();d("Error: ".concat(e.error))}}catch(e){console.error("Error:",e)}};return(0,o.useEffect)(()=>{p.includes("")||t(e=>({...e,img:p}))},[p]),(0,a.jsxs)("div",{className:"container mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:h?"Edit Category":"Add Category"}),(0,a.jsxs)("form",{onSubmit:h?f:b,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",className:"border p-2 w-full",value:h?r.name:e.name,onChange:a=>h?n({...r,name:a.target.value}):t({...e,name:a.target.value}),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1",children:"Type"}),(0,a.jsxs)("select",{className:"border p-2 w-full",value:h?r.type:e.type,onChange:a=>h?n({...r,type:a.target.value}):t({...e,type:a.target.value}),children:[(0,a.jsx)("option",{value:"products",children:"Products"}),(0,a.jsx)("option",{value:"parts",children:"Parts"})]})]}),(0,a.jsx)(s.Z,{HandleImagesChange:e=>{e&&m(e)}}),(0,a.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2",children:h?"Update Category":"Add Category"})]}),c&&(0,a.jsx)("p",{className:"mt-4",children:c}),(0,a.jsx)("h2",{className:"text-xl font-bold mt-8",children:"All Categories"}),(0,a.jsxs)("table",{className:"table-auto border-collapse border border-gray-300 w-full mt-4",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"border border-gray-300 p-2",children:"Name"}),(0,a.jsx)("th",{className:"border border-gray-300 p-2",children:"Type"}),(0,a.jsx)("th",{className:"border border-gray-300 p-2",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:i.length>0?i.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"border border-gray-300 p-2",children:e.name}),(0,a.jsx)("td",{className:"border border-gray-300 p-2",children:e.type}),(0,a.jsxs)("td",{className:"border border-gray-300 p-2 text-center",children:[(0,a.jsx)("button",{onClick:()=>x(e),className:"bg-yellow-500 text-white px-4 py-1 rounded mr-2",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>j(e.id),className:"bg-red-500 text-white px-4 py-1 rounded",children:"Delete"})]})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:"No categories found."})})})]}),(0,a.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n  .uploadcare--widget {\n    background:black;\n  }\n  "}})]})}},8515:function(e,t,r){"use strict";var a=r(3955),o=r(2312),s=r(5852),l=r(2310);t.Z=e=>{let{defaultValue:t,HandleImagesChange:r}=e,[n,c]=(0,l.useState)(!0),[d,i]=(0,l.useState)([]);return(0,a.jsx)(o.Z,{sx:{pt:"1.5em"},children:n&&(0,a.jsx)(s.W,{clearable:!0,multiple:!0,imagesOnly:!0,onChange:()=>{r(d)},onFileSelect:async e=>{let t=e&&e.files();if(!t)return;let r=[];for(let e=0;e<t.length;e++)t[e].done(e=>{(null==e?void 0:e.cdnUrl)&&r.push("".concat(e.cdnUrl))});i(r)},publicKey:"998cbc4a64cbfa34b932"})})}},6008:function(e,t,r){e.exports=r(794)}},function(e){e.O(0,[722,704,801,744],function(){return e(e.s=7859)}),_N_E=e.O()}]);